# Production Deployment Guidelines for Pets of World

This document outlines the proper steps to deploy the Pets of World application to a production environment while ensuring HTTPS is properly configured to prevent mixed content warnings.

## Configuration Changes Made

1. **Updated AppServiceProvider**
   - Modified `app/Providers/AppServiceProvider.php` to force HTTPS in production environments
   - This ensures all URLs generated by the application use the HTTPS protocol

2. **Enhanced Asset Handling**
   - Updated `resources/views/layouts/app.blade.php` to use `secure_asset()` helper in production
   - This ensures assets are loaded over HTTPS to prevent mixed content warnings

3. **Vite Configuration Updates**
   - Modified `vite.config.js` to support HTTPS in production environment

4. **Created Production .env File**
   - Created `.env.production` with proper production settings
   - Added `ASSET_URL` setting to ensure assets are served from the correct domain
   - Set `APP_DEBUG=false` for security and performance
   - Configured DB connection settings for Railway

## Deployment Steps

1. **Copy the Production .env File**

   Copy `.env.production` to `.env` on your production server:
   ```bash
   cp .env.production .env
   ```

2. **Optimize the Application**

   Run these commands to prepare the application for production:
   ```bash
   php artisan config:cache
   php artisan route:cache
   php artisan view:cache
   php artisan optimize
   ```

3. **Compile Assets**

   Ensure all assets are compiled for production:
   ```bash
   npm run build
   ```

4. **Database Migration**

   Run migrations if needed:
   ```bash
   php artisan migrate --force
   ```

5. **Test HTTPS Configuration**

   After deployment, verify all assets are being served over HTTPS by:
   - Opening browser developer tools (F12)
   - Go to the Network tab
   - Look for any resources loaded over HTTP (they should all be HTTPS)

## Troubleshooting Mixed Content Issues

If you still encounter mixed content warnings:

1. **Check Your Code**
   - Look for hardcoded `http://` URLs in your JavaScript or CSS files
   - Check for HTTP URLs in your database content

2. **Verify Server Configuration**
   - Ensure your web server is properly configured to redirect HTTP to HTTPS
   - Check that your SSL certificate is valid and properly installed

3. **Content Security Policy**
   - Consider implementing a Content Security Policy to further secure your application:
   ```php
   // Add this to your middleware or headers
   header("Content-Security-Policy: upgrade-insecure-requests");
   ```

4. **Third-Party Resources**
   - Ensure all third-party resources are loaded via HTTPS
   - Replace any CDN links that use HTTP with HTTPS versions

## Maintaining HTTPS in Development

For a consistent experience between development and production, consider using a local SSL certificate in your development environment with Laravel Valet or Laravel Sail.

---

If you encounter any issues during deployment, refer to the [Laravel Deployment Documentation](https://laravel.com/docs/deployment) for additional guidance.